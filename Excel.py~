import os
import os.path
import glob



data_path='/home/karim/Data/'
output_path= '/home/karim/Exp/septembre/vendredi'


subject_basename='subject'
data_basename='201'

mask_basename='smoothed_segment'

subjectSet=glob.glob(data_path+subject_basename+'*')
subjectSet.sort()


for subject in range (0,len(subjectSet)):

    static_image=glob.glob(subjectSet[subject]+'/'+data_basename+'*.nii.gz')
    go='time python -s '+ static_image[0]

    output_path2= output_path + '/subject0'+str(subject+1)


    maskSet=glob.glob(subjectSet[subject]+'/segment/smoothed_segment/'+mask_basename+'*.nii.gz')
    maskSet.sort()

    go1= go+ ' -m '+ maskSet[0] + ' -m '+ maskSet[1] + ' -m '+ maskSet[2]

    dynamic_sequenceSet=glob.glob(subjectSet[subject]+'/dynamic/'+data_basename+'*')
    dynamic_sequenceSet.sort()

    sequence=0
    while(sequence < len(dynamic_sequenceSet)):
        sequence_name=os.path.basename(dynamic_sequenceSet[sequence])
        sequence_name_without_extension = sequence_name[:sequence_name.index('.')]

        output_path3= output_path2+'/'+sequence_name_without_extension+'/'
        if not os.path.exists(output_path3):
           os.makedirs(output_path3)

        go2= go1 + ' -d ' + dynamic_sequenceSet[sequence] + ' -o ' + output_path3
        print(go2)
        os.system(go2)
        sequence+=1
